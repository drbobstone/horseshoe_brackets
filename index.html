<!DOCTYPE html>
<html>
<head>
  <title>Horseshoes Bracket Generator</title>
  <style>
    body { font-family: sans-serif; }
    #container { display: block; }
    #input { margin-bottom: 20px; }
    #bracket-output {
        position: relative;
        margin-top: 20px;
    }
    .round {
        float: left;
        margin-right: 40px;
    }
    .match {
        margin-bottom: 40px;
        position: relative;
    }
    .team {
        display: block;
        padding: 5px;
        border: 1px solid #ccc;
        background-color: #f5f5f5;
        width: 150px;
    }
    .match-connector {
        position: absolute;
        width: 20px;
        height: 2px;
        background-color: #ccc;
        top: 50%;
        left: 100%;
    }
    .round-connector {
        position: absolute;
        width: 2px;
        background-color: #ccc;
        left: 170px; /* .team width + .match-connector width */
    }
  </style>
</head>
<body>
  <h1>Horseshoes Bracket Generator</h1>
  <div id="container">
    <div id="input">
      <h2>Participants</h2>
      <textarea id="participants" rows="10" cols="30"></textarea>
      <br>
      <button id="randomizeBtn" onclick="randomize()">Randomize</button>
    </div>
    <div id="output">
      <h2>Teams</h2>
      <ul id="teams"></ul>
    </div>
    <div id="bracket-output">
      <h2>Bracket</h2>
      <div id="bracket-image-container"></div>
    </div>
  </div>

  <script>
    async function randomize() {
      document.getElementById('randomizeBtn').disabled = true;
      const participants = document.getElementById('participants').value.split('\n').filter(p => p.trim() !== '');
      const response = await fetch('http://localhost:4567/randomize', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ participants })
      });
      const data = await response.json();
      displayResults(data);
    }

    function displayResults(data) {
      const teamsList = document.getElementById('teams');
      teamsList.innerHTML = '';
      data.teams.forEach(team => {
        const li = document.createElement('li');
        li.textContent = team.join(' and ');
        teamsList.appendChild(li);
      });

      const bracketContainer = document.getElementById('bracket-image-container');
      bracketContainer.innerHTML = '';
      const bracketImage = document.createElement('img');
      bracketImage.src = data.bracket_image;
      bracketContainer.appendChild(bracketImage);
    }
  </script>
</body>
</html>
